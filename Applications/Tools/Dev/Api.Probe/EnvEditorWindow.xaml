<Window x:Class="ApiProbe.EnvEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="환경 변수 편집" Height="520" Width="700"
        MinHeight="400" MinWidth="540"
        Background="{StaticResource Bg0Brush}"
        Foreground="{StaticResource FgBrush}"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False">
  <Grid Margin="16">
    <Grid.RowDefinitions>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- ── 본문 ───────────────────────────────────────────────── -->
    <Grid Grid.Row="0">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="180" MinWidth="140"/>
        <ColumnDefinition Width="14"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <!-- ── 왼쪽: 환경 목록 ─────────────────────────────────── -->
      <Grid Grid.Column="0">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="환경"
                   Foreground="{StaticResource FgDimBrush}"
                   FontSize="11" Margin="0,0,0,6"/>

        <Border Grid.Row="1" Background="{StaticResource Bg1Brush}"
                BorderBrush="{StaticResource BorderBrush2}"
                BorderThickness="1" CornerRadius="5">
          <ListBox x:Name="LstEnv"
                   Background="Transparent"
                   BorderThickness="0"
                   ScrollViewer.VerticalScrollBarVisibility="Auto"
                   SelectionChanged="LstEnv_SelectionChanged">
            <ListBox.ItemTemplate>
              <DataTemplate>
                <TextBlock Text="{Binding Name}" FontSize="13" Padding="2"/>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>
        </Border>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,8,0,0">
          <Button Content="+ 추가" Click="AddEnv"
                  Padding="8,5" FontSize="12" Margin="0,0,6,0"/>
          <Button Content="삭제"   Click="DeleteEnv"
                  Padding="8,5" FontSize="12"/>
        </StackPanel>
      </Grid>

      <!-- ── 오른쪽: 변수 편집 ────────────────────────────────── -->
      <Grid Grid.Column="2">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 환경 이름 편집 -->
        <Grid Grid.Row="0" Margin="0,0,0,10">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="36"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>
          <TextBlock Grid.Column="0" Text="이름"
                     Foreground="{StaticResource FgDimBrush}"
                     FontSize="11" VerticalAlignment="Center"/>
          <TextBox x:Name="TxtEnvName" Grid.Column="1"
                   FontSize="13" IsEnabled="False"
                   LostFocus="TxtEnvName_LostFocus"/>
        </Grid>

        <!-- 변수 레이블 -->
        <TextBlock Grid.Row="1" Text="변수"
                   Foreground="{StaticResource FgDimBrush}"
                   FontSize="11" Margin="0,0,0,6"/>

        <!-- DataGrid: 키/값 편집 -->
        <Border Grid.Row="2" Background="{StaticResource Bg1Brush}"
                BorderBrush="{StaticResource BorderBrush2}"
                BorderThickness="1" CornerRadius="5"
                ClipToBounds="True">
          <DataGrid x:Name="VarGrid"
                    AutoGenerateColumns="False"
                    CanUserAddRows="False" CanUserDeleteRows="False"
                    CanUserReorderColumns="False" CanUserSortColumns="False"
                    CanUserResizeColumns="True"
                    IsEnabled="False">
            <DataGrid.Columns>
              <DataGridTextColumn Header="키"
                                  Binding="{Binding Key, UpdateSourceTrigger=PropertyChanged}"
                                  Width="180"/>
              <DataGridTextColumn Header="값"
                                  Binding="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                                  Width="*"/>
            </DataGrid.Columns>
          </DataGrid>
        </Border>

        <!-- 변수 추가/삭제 버튼 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,8,0,0">
          <Button Content="+ 변수 추가" Click="AddVar"
                  Padding="8,5" FontSize="12" Margin="0,0,6,0"
                  IsEnabled="False" x:Name="BtnAddVar"/>
          <Button Content="삭제" Click="DeleteVar"
                  Padding="8,5" FontSize="12"
                  IsEnabled="False" x:Name="BtnDeleteVar"/>
        </StackPanel>
      </Grid>
    </Grid>

    <!-- ── 하단: 닫기(저장) 버튼 ────────────────────────────── -->
    <Button Grid.Row="1" Content="저장 후 닫기"
            HorizontalAlignment="Right" Padding="24,7" Margin="0,12,0,0"
            FontSize="13" Style="{StaticResource AccentButton}"
            Click="Close_Click"/>
  </Grid>
</Window>
