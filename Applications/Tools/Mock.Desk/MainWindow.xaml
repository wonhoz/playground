<Window x:Class="MockDesk.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Mock.Desk" Height="700" Width="1000"
        MinHeight="540" MinWidth="760"
        Background="{StaticResource Bg0Brush}"
        Foreground="{StaticResource FgBrush}"
        WindowStartupLocation="CenterScreen"
        Icon="Resources/app.ico"
        Closing="Window_Closing">
  <Grid>
    <Grid.RowDefinitions>
      <!-- 헤더 서버 제어 -->
      <RowDefinition Height="Auto"/>
      <!-- 메인 분할 (엔드포인트 목록 + 에디터 + 로그) -->
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- ── 헤더 서버 제어 바 ──────────────────────────────────── -->
    <Border Grid.Row="0" Background="{StaticResource Bg1Brush}"
            Padding="16,10" BorderThickness="0,0,0,1"
            BorderBrush="{StaticResource BorderBrush2}">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- 앱 타이틀 -->
        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
          <TextBlock Text="Mock.Desk" FontSize="16" FontWeight="Bold"
                     Foreground="{StaticResource AccentBrush}" Margin="0,0,8,0"/>
          <TextBlock Text="로컬 Mock HTTP 서버" FontSize="12"
                     Foreground="{StaticResource FgDimBrush}"
                     VerticalAlignment="Center"/>
        </StackPanel>

        <!-- 포트 + 서버 제어 -->
        <StackPanel Grid.Column="2" Orientation="Horizontal">
          <TextBlock Text="포트:" VerticalAlignment="Center"
                     Foreground="{StaticResource FgDimBrush}" Margin="0,0,8,0" FontSize="13"/>
          <TextBox x:Name="TxtPort" Width="70" Text="8888" FontSize="13"
                   HorizontalContentAlignment="Center" Margin="0,0,10,0"/>
          <Button x:Name="BtnStart" Content="▶ 시작"
                  Style="{StaticResource AccentButton}"
                  Click="ToggleServer" Width="90"/>
          <Border Width="1" Background="{StaticResource BorderBrush2}" Margin="12,2"/>
          <Button Content="내보내기" Click="ExportConfig" Padding="8,6" Margin="0,0,6,0"/>
          <Button Content="가져오기" Click="ImportConfig" Padding="8,6"/>
        </StackPanel>
      </Grid>
    </Border>

    <!-- ── 메인 분할 ──────────────────────────────────────────── -->
    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <!-- 엔드포인트 목록 -->
        <ColumnDefinition Width="260" MinWidth="180" MaxWidth="400"/>
        <ColumnDefinition Width="4"/>
        <!-- 에디터 + 로그 -->
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <!-- ── 엔드포인트 목록 ───────────────────────────────────── -->
      <Border Grid.Column="0" Background="{StaticResource Bg1Brush}">
        <DockPanel LastChildFill="True">
          <Border DockPanel.Dock="Top" Padding="10,8" BorderThickness="0,0,0,1"
                  BorderBrush="{StaticResource BorderBrush2}">
            <StackPanel Orientation="Horizontal">
              <TextBlock Text="엔드포인트" FontWeight="SemiBold" FontSize="13"
                         Foreground="{StaticResource FgBrush}" Margin="0,0,8,0"
                         VerticalAlignment="Center"/>
              <Button Content="+" Click="AddEndpoint" Padding="6,2" FontSize="14"
                      ToolTip="새 엔드포인트 추가"/>
            </StackPanel>
          </Border>

          <ScrollViewer VerticalScrollBarVisibility="Auto">
            <ListBox x:Name="EndpointList"
                     SelectionChanged="EndpointList_SelectionChanged"
                     Padding="6">
            </ListBox>
          </ScrollViewer>
        </DockPanel>
      </Border>

      <!-- 스플리터 -->
      <GridSplitter Grid.Column="1" Width="4"
                    Background="{StaticResource BorderBrush2}"
                    HorizontalAlignment="Stretch"/>

      <!-- ── 우측: 에디터 + 요청 로그 ─────────────────────────── -->
      <Grid Grid.Column="2">
        <Grid.RowDefinitions>
          <RowDefinition Height="*" MinHeight="200"/>
          <RowDefinition Height="6"/>
          <RowDefinition Height="220" MinHeight="100"/>
        </Grid.RowDefinitions>

        <!-- 엔드포인트 편집기 -->
        <Border Grid.Row="0" Background="{StaticResource Bg0Brush}">
          <Grid x:Name="EditorPanel">
            <TextBlock x:Name="TxtEditorPlaceholder"
                       Text="← 엔드포인트를 선택하거나 새로 추가하세요."
                       Foreground="{StaticResource FgDimBrush}"
                       HorizontalAlignment="Center" VerticalAlignment="Center"
                       FontSize="14"/>

            <ScrollViewer x:Name="EditorScroll" Visibility="Collapsed"
                          VerticalScrollBarVisibility="Auto">
              <StackPanel Margin="16" MaxWidth="640">
                <!-- 활성화 + 삭제 -->
                <Grid Margin="0,0,0,14">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>
                  <CheckBox x:Name="ChkEnabled" Grid.Column="0"
                            Content="활성화"
                            IsChecked="True"
                            Checked="Editor_Changed" Unchecked="Editor_Changed"
                            VerticalAlignment="Center"/>
                  <Button Grid.Column="1" Content="삭제"
                          Style="{StaticResource DangerButton}"
                          Click="DeleteEndpoint" Padding="8,4"/>
                </Grid>

                <!-- 메서드 + 경로 -->
                <Grid Margin="0,0,0,10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="110"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <ComboBox x:Name="CmbEdMethod" Grid.Column="0" Margin="0,0,8,0"
                            SelectionChanged="Editor_Changed">
                    <ComboBoxItem Content="GET"    IsSelected="True"/>
                    <ComboBoxItem Content="POST"/>
                    <ComboBoxItem Content="PUT"/>
                    <ComboBoxItem Content="PATCH"/>
                    <ComboBoxItem Content="DELETE"/>
                  </ComboBox>
                  <TextBox x:Name="TxtEdPath" Grid.Column="1"
                           FontFamily="Consolas" Text="/api/endpoint"
                           TextChanged="Editor_Changed"/>
                </Grid>

                <!-- 상태 코드 + 지연 -->
                <Grid Margin="0,0,0,10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>
                  <StackPanel Grid.Column="0" Margin="0,0,8,0">
                    <TextBlock Text="상태 코드" FontSize="12"
                               Foreground="{StaticResource FgDimBrush}" Margin="0,0,0,4"/>
                    <ComboBox x:Name="CmbEdStatus" SelectionChanged="Editor_Changed">
                      <ComboBoxItem Content="200 OK"           IsSelected="True"/>
                      <ComboBoxItem Content="201 Created"/>
                      <ComboBoxItem Content="204 No Content"/>
                      <ComboBoxItem Content="400 Bad Request"/>
                      <ComboBoxItem Content="401 Unauthorized"/>
                      <ComboBoxItem Content="403 Forbidden"/>
                      <ComboBoxItem Content="404 Not Found"/>
                      <ComboBoxItem Content="422 Unprocessable"/>
                      <ComboBoxItem Content="500 Internal Error"/>
                    </ComboBox>
                  </StackPanel>
                  <StackPanel Grid.Column="1">
                    <TextBlock Text="지연 시간 (ms)" FontSize="12"
                               Foreground="{StaticResource FgDimBrush}" Margin="0,0,0,4"/>
                    <TextBox x:Name="TxtEdDelay" Text="0"
                             FontFamily="Segoe UI" TextChanged="Editor_Changed"/>
                  </StackPanel>
                </Grid>

                <!-- 설명 -->
                <TextBlock Text="설명 (선택)" FontSize="12"
                           Foreground="{StaticResource FgDimBrush}" Margin="0,0,0,4"/>
                <TextBox x:Name="TxtEdDesc" FontFamily="Segoe UI" Margin="0,0,0,10"
                         TextChanged="Editor_Changed"/>

                <!-- 응답 바디 -->
                <TextBlock Text="응답 JSON 바디" FontSize="12"
                           Foreground="{StaticResource FgDimBrush}" Margin="0,0,0,4"/>
                <TextBox x:Name="TxtEdBody"
                         AcceptsReturn="True" AcceptsTab="True"
                         Height="200"
                         TextWrapping="NoWrap"
                         VerticalScrollBarVisibility="Auto"
                         HorizontalScrollBarVisibility="Auto"
                         FontFamily="Consolas" FontSize="13"
                         Text=""
                         TextChanged="Editor_Changed"/>
              </StackPanel>
            </ScrollViewer>
          </Grid>
        </Border>

        <!-- 가로 스플리터 -->
        <GridSplitter Grid.Row="1" Height="6"
                      Background="{StaticResource BorderBrush2}"
                      HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

        <!-- 요청 로그 -->
        <Border Grid.Row="2" Background="{StaticResource Bg1Brush}">
          <DockPanel LastChildFill="True">
            <Border DockPanel.Dock="Top" Padding="12,8" BorderThickness="0,0,0,1"
                    BorderBrush="{StaticResource BorderBrush2}">
              <Grid>
                <StackPanel Orientation="Horizontal">
                  <TextBlock Text="요청 로그" FontWeight="SemiBold" FontSize="13"
                             Foreground="{StaticResource FgBrush}" Margin="0,0,12,0"
                             VerticalAlignment="Center"/>
                  <Border x:Name="ServerStatus" CornerRadius="4" Padding="8,2"
                          Background="{StaticResource Bg3Brush}">
                    <TextBlock x:Name="TxtServerStatus" Text="● 중지됨" FontSize="12"
                               Foreground="{StaticResource FgDimBrush}"/>
                  </Border>
                </StackPanel>
                <Button Content="지우기" Click="ClearLog"
                        HorizontalAlignment="Right" Padding="8,4" FontSize="12"/>
              </Grid>
            </Border>

            <ScrollViewer x:Name="LogScroll" VerticalScrollBarVisibility="Auto">
              <ListBox x:Name="LogList"
                       FontFamily="Consolas" FontSize="12"
                       Padding="6">
              </ListBox>
            </ScrollViewer>
          </DockPanel>
        </Border>
      </Grid>
    </Grid>
  </Grid>
</Window>
