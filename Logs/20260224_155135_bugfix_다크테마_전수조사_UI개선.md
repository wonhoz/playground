# 전체 프로젝트 다크 테마 전수 조사 및 UI 개선

- **날짜**: 2026-02-24 (KST)
- **태그**: `bugfix`

---

## 작업 개요

솔루션 내 모든 WinForms/WPF 프로젝트의 UI 컨트롤 다크 테마 미적용 요소 전수 수정.
핵심 문제: OS 기본 크롬(Chrome)이 Background/Foreground 속성 설정을 무시 → ControlTemplate 재정의 필요.

---

## 수정 파일 목록

### Toast.Cast (WinForms)
- **DarkMenuRenderer.cs**: `ToolStripProfessionalRenderer` → `ToolStripRenderer` 직접 상속으로 변경
  - Professional 렌더러는 `ShowImageMargin=false` 설정에도 내부 이미지 마진 공간 예약 → 짜부러짐 유발
  - `ToolStripRenderer` 직접 상속으로 완전한 레이아웃 제어 획득
- **SettingsWindow.cs**: CheckBox에 `FlatStyle.Flat` + `FlatAppearance.CheckedBackColor` 추가
  - 체크박스 사각형이 OS 기본(흰 배경) → FlatStyle.Flat으로 다크 테마 적용

### Env.Guard (WPF)
- **App.xaml**: 전역 다크 테마 스타일 추가 (ScrollBar, ComboBox, ComboBoxItem, CheckBox, RadioButton)
- **MainWindow.xaml**:
  - `DataGridColumnHeader`: ControlTemplate 추가 (DataGridHeaderBorder 크롬 오버라이드)
  - `DataGridRow`: 선택/호버 스타일 추가
  - `ListBoxItem`: PATH 리스트 선택/호버 스타일 추가

### Log.Lens (WPF)
- **App.xaml**: 전역 다크 테마 스타일 추가
- **MainWindow.xaml**: 키 스타일 `DarkCheckBox`, `DarkComboBox` 제거 → App.xaml 전역 스타일 자동 적용

### Link.Vault (WPF)
- **App.xaml**: 전역 다크 테마 스타일 추가
- **MainWindow.xaml**: 로컬 CheckBox TargetType 스타일 제거 → App.xaml 전역 스타일 적용

### 나머지 WPF 프로젝트 (App.xaml 추가)
- Music.Player, Batch.Rename, File.Duplicates, Photo.Video.Organizer
- Clipboard.Stacker, Screen.Recorder, Text.Forge

### File.Duplicates 추가 수정
- **MainWindow.xaml**: 로컬 ScrollBar 스타일 (ControlTemplate 없음) 제거 → App.xaml 전역 스타일 적용

---

## 핵심 패턴 (재발 방지)

### WPF - ControlTemplate 필수 컨트롤
```xml
<!-- App.xaml에 global(키 없음) 스타일로 추가 필수 -->
<Style TargetType="ComboBox">    <!-- PART_Popup 포함 전체 Template 재정의 -->
<Style TargetType="CheckBox">    <!-- Border + Path 직접 그리기 -->
<Style TargetType="RadioButton"> <!-- Ellipse 직접 그리기 -->
<Style TargetType="ScrollBar">   <!-- Track + Thumb 직접 그리기 -->
<Style TargetType="DataGridColumnHeader"> <!-- DataGridHeaderBorder 오버라이드 -->
```

### WinForms - DarkMenuRenderer
```csharp
// ToolStripRenderer 직접 상속 (ProfessionalRenderer 사용 금지)
public class DarkMenuRenderer : ToolStripRenderer { ... }
```

### WinForms - CheckBox
```csharp
var chk = new CheckBox { FlatStyle = FlatStyle.Flat, BackColor = darkBg };
chk.FlatAppearance.CheckedBackColor = accentColor;
chk.FlatAppearance.BorderColor = borderColor;
```

---

## 빌드 결과

전체 솔루션 `dotnet build Playground.slnx -c Release`: **경고 0 / 오류 0**
