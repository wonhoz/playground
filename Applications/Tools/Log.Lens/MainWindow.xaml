<Window x:Class="LogLens.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Log.Lens — 실시간 로그 뷰어" Width="1200" Height="750"
        MinWidth="800" MinHeight="500"
        WindowStartupLocation="CenterScreen"
        Background="#0F0F1A"
        AllowDrop="True"
        Drop="Window_Drop" DragOver="Window_DragOver">

    <Window.Resources>
        <!-- 탭 아이템 스타일 -->
        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Bd" Padding="12,6" Margin="0,0,2,0" CornerRadius="6,6,0,0"
                                Background="#1A1A2E" BorderThickness="0" Cursor="Hand">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{TemplateBinding Header}" Foreground="#A0A0B0" FontSize="12"
                                           VerticalAlignment="Center" x:Name="Txt"/>
                                <Button Content="✕" FontSize="10" Margin="8,0,0,0"
                                        Background="Transparent" BorderThickness="0" Foreground="#606070"
                                        Cursor="Hand" Padding="4,1" VerticalAlignment="Center"
                                        Click="CloseTab_Click" Tag="{TemplateBinding Tag}">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="#FF6060"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#252540"/>
                                <Setter TargetName="Txt" Property="Foreground" Value="#00C8FF"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#202038"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 텍스트 박스 스타일 -->
        <Style x:Key="DarkTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="#1A1A2E"/>
            <Setter Property="Foreground" Value="#E0E0E0"/>
            <Setter Property="BorderBrush" Value="#333350"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="CaretBrush" Value="#00C8FF"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 버튼 스타일 -->
        <Style x:Key="DarkButton" TargetType="Button">
            <Setter Property="Background" Value="#252540"/>
            <Setter Property="Foreground" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}"
                                CornerRadius="4" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#303058"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#3A3A68"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 체크박스/콤보박스: App.xaml 전역 스타일 사용 (ControlTemplate 포함)
             x:Key 스타일로 덮어쓰면 App.xaml ControlTemplate이 무시됨 — 삭제 처리 -->
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 상단 툴바 -->
        <Border Grid.Row="0" Background="#141428" Padding="10,8">
            <DockPanel>
                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                    <TextBlock Text="🔍" FontSize="18" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBlock Text="Log.Lens" FontSize="16" FontWeight="Bold" Foreground="#00C8FF"
                               VerticalAlignment="Center" Margin="0,0,20,0"/>
                    <Button Content="📂 파일 열기" Style="{StaticResource DarkButton}" Click="OpenFile_Click"
                            Margin="0,0,6,0"/>
                    <Button Content="📁 폴더 열기" Style="{StaticResource DarkButton}" Click="OpenFolder_Click"
                            Margin="0,0,6,0"/>
                </StackPanel>
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" HorizontalAlignment="Right">
                    <CheckBox x:Name="ChkAutoScroll" Content="자동 스크롤" IsChecked="True"
                              Margin="0,0,12,0"/>
                    <CheckBox x:Name="ChkWordWrap" Content="줄 바꿈" IsChecked="False"
                              Unchecked="WordWrap_Changed" Checked="WordWrap_Changed"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- 필터/검색 바 -->
        <Border Grid.Row="1" Background="#121224" Padding="10,6">
            <DockPanel>
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" Margin="8,0,0,0">
                    <CheckBox x:Name="ChkRegex" Content="정규식"
                              Margin="0,0,10,0"/>
                    <ComboBox x:Name="CmbLevel" Width="100"
                              SelectionChanged="LevelFilter_Changed">
                        <ComboBoxItem Content="모든 레벨" IsSelected="True"/>
                        <ComboBoxItem Content="TRACE+"/>
                        <ComboBoxItem Content="DEBUG+"/>
                        <ComboBoxItem Content="INFO+"/>
                        <ComboBoxItem Content="WARN+"/>
                        <ComboBoxItem Content="ERROR+"/>
                        <ComboBoxItem Content="FATAL"/>
                    </ComboBox>
                </StackPanel>
                <TextBox x:Name="TxtFilter" Style="{StaticResource DarkTextBox}"
                         TextChanged="Filter_TextChanged"
                         Tag="🔎 필터 (키워드 또는 정규식)..."
                         GotFocus="FilterBox_GotFocus" LostFocus="FilterBox_LostFocus"/>
            </DockPanel>
        </Border>

        <!-- 탭 + 로그 뷰 -->
        <TabControl x:Name="TabLogs" Grid.Row="2" Background="Transparent" BorderThickness="0"
                    Padding="0" Margin="0"
                    SelectionChanged="TabLogs_SelectionChanged">
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem" BasedOn="{StaticResource TabItemStyle}"/>
            </TabControl.ItemContainerStyle>
        </TabControl>

        <!-- 빈 상태 -->
        <Border x:Name="EmptyState" Grid.Row="2" Visibility="Visible">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="📋" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                <TextBlock Text="로그 파일을 드래그 앤 드롭하거나" FontSize="16" Foreground="#606080"
                           HorizontalAlignment="Center"/>
                <TextBlock Text="상단의 '파일 열기' 버튼을 클릭하세요" FontSize="16" Foreground="#606080"
                           HorizontalAlignment="Center" Margin="0,4,0,0"/>
                <TextBlock Text="지원 형식: .log, .txt, .csv 등 모든 텍스트 파일" FontSize="12"
                           Foreground="#404060" HorizontalAlignment="Center" Margin="0,16,0,0"/>
            </StackPanel>
        </Border>

        <!-- 상태 바 -->
        <Border Grid.Row="3" Background="#141428" Padding="10,5">
            <DockPanel>
                <TextBlock x:Name="TxtStatus" Text="준비" Foreground="#808090" FontSize="11"
                           DockPanel.Dock="Left" VerticalAlignment="Center"/>
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" HorizontalAlignment="Right">
                    <TextBlock x:Name="TxtLineInfo" Text="" Foreground="#808090" FontSize="11"
                               VerticalAlignment="Center" Margin="0,0,16,0"/>
                    <TextBlock x:Name="TxtFilterInfo" Text="" Foreground="#00C8FF" FontSize="11"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </DockPanel>
        </Border>
    </Grid>
</Window>
