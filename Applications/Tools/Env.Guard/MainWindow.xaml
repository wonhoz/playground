<Window x:Class="EnvGuard.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Env.Guard — 환경변수 관리자" Width="1100" Height="750"
        MinWidth="800" MinHeight="550"
        WindowStartupLocation="CenterScreen"
        Background="#0F1018">

    <Window.Resources>
        <!-- 공통 스타일 -->
        <Style x:Key="DarkBtn" TargetType="Button">
            <Setter Property="Background" Value="#252540"/>
            <Setter Property="Foreground" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="14,7"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}"
                                CornerRadius="5" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#303058"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#3A3A68"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="AccentBtn" TargetType="Button" BasedOn="{StaticResource DarkBtn}">
            <Setter Property="Background" Value="#2855A0"/>
        </Style>

        <Style x:Key="DangerBtn" TargetType="Button" BasedOn="{StaticResource DarkBtn}">
            <Setter Property="Background" Value="#802020"/>
        </Style>

        <Style x:Key="DarkTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="#1A1A2E"/>
            <Setter Property="Foreground" Value="#E0E0E0"/>
            <Setter Property="BorderBrush" Value="#333350"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="CaretBrush" Value="#40A0FF"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- DataGrid 스타일 -->
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="#12121E"/>
            <Setter Property="Foreground" Value="#D0D0D8"/>
            <Setter Property="BorderBrush" Value="#252540"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="RowBackground" Value="#14142A"/>
            <Setter Property="AlternatingRowBackground" Value="#181830"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#222240"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="RowHeight" Value="32"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#1E1E38"/>
            <Setter Property="Foreground" Value="#A0A0C0"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderBrush" Value="#303050"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                            <ContentPresenter VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#2A2A55"/>
                    <Setter Property="Foreground" Value="#FFFFFF"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 헤더 -->
        <Border Grid.Row="0" Background="#141428" Padding="12,10">
            <DockPanel>
                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                    <TextBlock Text="🛡️" FontSize="20" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBlock Text="Env.Guard" FontSize="17" FontWeight="Bold" Foreground="#40A0FF"
                               VerticalAlignment="Center"/>
                    <TextBlock x:Name="TxtAdmin" Text="  (관리자)" FontSize="11" Foreground="#50DD70"
                               VerticalAlignment="Center" Visibility="Collapsed"/>
                </StackPanel>
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="📸 스냅샷 저장" Style="{StaticResource AccentBtn}" Click="SaveSnapshot_Click"
                            Margin="0,0,6,0"/>
                    <Button Content="📋 스냅샷 목록" Style="{StaticResource DarkBtn}" Click="ListSnapshots_Click"
                            Margin="0,0,6,0"/>
                    <Button Content="🔄 새로고침" Style="{StaticResource DarkBtn}" Click="Refresh_Click"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- 검색/필터 -->
        <Border Grid.Row="1" Background="#121224" Padding="12,8">
            <DockPanel>
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" Margin="10,0,0,0">
                    <RadioButton x:Name="RbAll" Content="전체" GroupName="Scope" IsChecked="True"
                                 Foreground="#A0A0B0" FontSize="12" Margin="0,0,12,0"
                                 Checked="ScopeFilter_Changed" VerticalContentAlignment="Center"/>
                    <RadioButton x:Name="RbUser" Content="사용자" GroupName="Scope"
                                 Foreground="#A0A0B0" FontSize="12" Margin="0,0,12,0"
                                 Checked="ScopeFilter_Changed" VerticalContentAlignment="Center"/>
                    <RadioButton x:Name="RbSystem" Content="시스템" GroupName="Scope"
                                 Foreground="#A0A0B0" FontSize="12"
                                 Checked="ScopeFilter_Changed" VerticalContentAlignment="Center"/>
                </StackPanel>
                <TextBox x:Name="TxtSearch" Style="{StaticResource DarkTextBox}"
                         TextChanged="Search_TextChanged"/>
            </DockPanel>
        </Border>

        <!-- 메인 콘텐츠: 탭 (변수 목록 / PATH 편집기) -->
        <TabControl Grid.Row="2" Background="Transparent" BorderThickness="0" Padding="0" Margin="0">
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border x:Name="Bd" Padding="16,8" Margin="0,0,2,0"
                                        CornerRadius="6,6,0,0" Background="#1A1A2E" Cursor="Hand">
                                    <TextBlock Text="{TemplateBinding Header}" x:Name="Txt"
                                               Foreground="#808098" FontSize="13"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="#252540"/>
                                        <Setter TargetName="Txt" Property="Foreground" Value="#40A0FF"/>
                                        <Setter TargetName="Txt" Property="FontWeight" Value="SemiBold"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.ItemContainerStyle>

            <!-- 환경변수 탭 -->
            <TabItem Header="📋 환경변수">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <DataGrid x:Name="DgVars" Grid.Row="0" AutoGenerateColumns="False"
                              IsReadOnly="True" SelectionMode="Single"
                              MouseDoubleClick="DgVars_DoubleClick"
                              HeadersVisibility="Column">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="범위" Binding="{Binding Scope}" Width="70"/>
                            <DataGridTextColumn Header="변수명" Binding="{Binding Name}" Width="220"/>
                            <DataGridTextColumn Header="값" Binding="{Binding Value}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- 하단 편집 영역 -->
                    <Border Grid.Row="1" Background="#141428" Padding="12,8">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <ComboBox x:Name="CmbScope" Grid.Column="0" FontSize="12"
                                      Background="#1A1A2E" Foreground="#E0E0E0" BorderBrush="#333350"
                                      VerticalContentAlignment="Center">
                                <ComboBoxItem Content="User" IsSelected="True"/>
                                <ComboBoxItem Content="System"/>
                            </ComboBox>

                            <TextBox x:Name="TxtName" Grid.Column="1" Style="{StaticResource DarkTextBox}"
                                     Margin="6,0,0,0"/>

                            <TextBox x:Name="TxtValue" Grid.Column="3" Style="{StaticResource DarkTextBox}"/>

                            <StackPanel Grid.Column="4" Orientation="Horizontal" Margin="8,0,0,0">
                                <Button Content="저장" Style="{StaticResource AccentBtn}" Click="SaveVar_Click"
                                        Margin="0,0,4,0" Padding="16,7"/>
                                <Button Content="삭제" Style="{StaticResource DangerBtn}" Click="DeleteVar_Click"
                                        Padding="16,7"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- PATH 편집기 탭 -->
            <TabItem Header="📂 PATH 편집기">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 사용자 PATH -->
                    <Grid Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="사용자 PATH" FontSize="14" FontWeight="SemiBold"
                                   Foreground="#40A0FF" Margin="0,0,0,8"/>
                        <ListBox x:Name="LbUserPath" Grid.Row="1" Background="#14142A"
                                 Foreground="#D0D0D8" BorderBrush="#252540" FontSize="12"
                                 FontFamily="Cascadia Mono, Consolas" Padding="4"
                                 SelectionChanged="PathList_SelectionChanged"/>
                        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,8,0,0">
                            <Button Content="⬆" Style="{StaticResource DarkBtn}" Click="MoveUp_Click"
                                    Tag="User" Padding="10,5" Margin="0,0,4,0"/>
                            <Button Content="⬇" Style="{StaticResource DarkBtn}" Click="MoveDown_Click"
                                    Tag="User" Padding="10,5" Margin="0,0,4,0"/>
                            <Button Content="➕ 추가" Style="{StaticResource AccentBtn}" Click="AddPath_Click"
                                    Tag="User" Padding="10,5" Margin="0,0,4,0"/>
                            <Button Content="🗑 제거" Style="{StaticResource DangerBtn}" Click="RemovePath_Click"
                                    Tag="User" Padding="10,5"/>
                        </StackPanel>
                    </Grid>

                    <!-- 시스템 PATH -->
                    <Grid Grid.Column="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="시스템 PATH" FontSize="14" FontWeight="SemiBold"
                                   Foreground="#FF8040" Margin="0,0,0,8"/>
                        <ListBox x:Name="LbSysPath" Grid.Row="1" Background="#14142A"
                                 Foreground="#D0D0D8" BorderBrush="#252540" FontSize="12"
                                 FontFamily="Cascadia Mono, Consolas" Padding="4"
                                 SelectionChanged="PathList_SelectionChanged"/>
                        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,8,0,0">
                            <Button Content="⬆" Style="{StaticResource DarkBtn}" Click="MoveUp_Click"
                                    Tag="System" Padding="10,5" Margin="0,0,4,0"/>
                            <Button Content="⬇" Style="{StaticResource DarkBtn}" Click="MoveDown_Click"
                                    Tag="System" Padding="10,5" Margin="0,0,4,0"/>
                            <Button Content="➕ 추가" Style="{StaticResource AccentBtn}" Click="AddPath_Click"
                                    Tag="System" Padding="10,5" Margin="0,0,4,0"/>
                            <Button Content="🗑 제거" Style="{StaticResource DangerBtn}" Click="RemovePath_Click"
                                    Tag="System" Padding="10,5"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- 상태 바 -->
        <Border Grid.Row="3" Background="#141428" Padding="12,6">
            <DockPanel>
                <TextBlock x:Name="TxtStatus" Text="준비" Foreground="#808090" FontSize="11"
                           DockPanel.Dock="Left" VerticalAlignment="Center"/>
                <TextBlock x:Name="TxtCount" Text="" Foreground="#60608A" FontSize="11"
                           DockPanel.Dock="Right" HorizontalAlignment="Right" VerticalAlignment="Center"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>
