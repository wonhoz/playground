# Batch.Rename + Window.Pilot 구현

**날짜**: 2026-02-21
**태그**: feature
**커밋**: `fae3835` (Batch.Rename), `757d3f2` (Window.Pilot), `109972d` (solution)

---

## Batch.Rename (Files)

### 기능
- 드래그앤드롭 또는 버튼으로 파일 추가
- **패턴 모드**: `{name}`, `{ext}`, `{date}`, `{date:format}`, `{num:N}`, `{exif}` 변수
- **정규식 모드**: Find/Replace (`$0`~`$9` 그룹 참조 + `{num:N}` 후처리)
- 실시간 Before/After DataGrid 미리보기 (중복·빈이름·특수문자 오류 표시)
- 실행 취소 스택 (`_undoStack`)
- MetadataExtractor로 EXIF DateTimeOriginal 읽기
- 최근 패턴 10개 저장

### 핵심 설계
| 파일 | 역할 |
|------|------|
| `Services/PatternEngine.cs` | Regex로 `{var:fmt}` 파싱, EXIF 날짜 포함 |
| `Services/RenameService.cs` | 미리보기 갱신 (중복 감지) + 실제 적용 + 실행 취소 |
| `MainWindow.xaml` | 탭(패턴/정규식), DataGrid, 드롭존, 변수 버튼 |

### 해결한 오류
- `{name}` 등 XAML Content: `{}{name}` 으로 이스케이프
- `Color` 모호성: `global using Color` 제외 → `DrawColor = System.Drawing.Color` 별칭
- `DragEventArgs`/`DataFormats`/`DragDropEffects`/`Button` 모호성: GlobalUsings 추가

---

## Window.Pilot (Tools)

### 기능
- **Ctrl+Shift+T**: 포커스 창 Always-on-Top 토글
- **Ctrl+Shift+마우스휠**: 투명도 ±10% (WH_MOUSE_LL 저수준 훅)
- **트레이 메뉴**:
  - 투명도 서브메뉴 (10%~100% 직접 선택)
  - 크기 프리셋: 1/4 화면 / 1/3 화면 / 1/2 화면 / 미니(200×150) / 복원
- **토스트 오버레이**: 작업 결과 우하단에 1.8초 표시

### 핵심 설계
| 파일 | 역할 |
|------|------|
| `Services/WindowManager.cs` | `SetWindowPos` TOPMOST, `SetLayeredWindowAttributes` 투명도, `MoveWindow` 크기 |
| `Services/MouseHookService.cs` | `WH_MOUSE_LL` 훅 → `WheelWithCtrlShift` 이벤트 |
| `Services/GlobalHotkeyService.cs` | `RegisterHotKey` Ctrl+Shift+T |
| `ToastOverlay.xaml/.cs` | `AllowsTransparency=True`, `IsHitTestVisible=False`, 1.8초 자동 숨김 |
| `App.xaml.cs` | 숨김 창 HWND → `HwndSource.AddHook(WndProc)` |

---

## 솔루션 등록

- `Playground.sln`: 두 프로젝트 추가
- `Playground.slnx`: Files/Tools 폴더에 추가
- `+publish-all.cmd`: 두 `call :pub` 추가

---

## 빌드 결과

```
솔루션 전체 (15 프로젝트): 경고 0 / 오류 0
```
