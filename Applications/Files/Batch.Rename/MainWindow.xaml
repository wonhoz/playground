<Window x:Class="BatchRename.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Batch Rename" Width="720" Height="560"
        MinWidth="600" MinHeight="420"
        Background="#1A1A2E" Foreground="#E0E0E0"
        AllowDrop="True"
        WindowStartupLocation="CenterScreen"
        Drop="Window_Drop" DragEnter="Window_DragEnter"
        Loaded="Window_Loaded">

    <Window.Resources>

        <!-- ë‹¤í¬ ë²„íŠ¼ -->
        <Style x:Key="DarkBtn" TargetType="Button">
            <Setter Property="Background"      Value="#2D2D4A"/>
            <Setter Property="Foreground"      Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding"         Value="14,6"/>
            <Setter Property="Cursor"          Value="Hand"/>
            <Setter Property="FontSize"        Value="12"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}"
                                CornerRadius="5" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#3A3A5C"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Bd" Property="Background" Value="#222235"/>
                                <Setter Property="Foreground" Value="#555577"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ê°•ì¡° ë²„íŠ¼ -->
        <Style x:Key="AccentBtn" TargetType="Button" BasedOn="{StaticResource DarkBtn}">
            <Setter Property="Background" Value="#00838F"/>
        </Style>

        <!-- ìœ„í—˜ ë²„íŠ¼ -->
        <Style x:Key="DangerBtn" TargetType="Button" BasedOn="{StaticResource DarkBtn}">
            <Setter Property="Background" Value="#5D1A1A"/>
        </Style>

        <!-- íƒ­ ë²„íŠ¼ (RadioButtonì²˜ëŸ¼ ë™ìž‘) -->
        <Style x:Key="TabBtn" TargetType="ToggleButton">
            <Setter Property="Background"      Value="Transparent"/>
            <Setter Property="Foreground"      Value="#888888"/>
            <Setter Property="BorderThickness" Value="0,0,0,2"/>
            <Setter Property="BorderBrush"     Value="Transparent"/>
            <Setter Property="Padding"         Value="16,6"/>
            <Setter Property="Cursor"          Value="Hand"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Foreground" Value="#00BCD4"/>
                                <Setter TargetName="Bd" Property="BorderBrush" Value="#00BCD4"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="#CCCCCC"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ë‹¤í¬ TextBox -->
        <Style x:Key="DarkTxt" TargetType="TextBox">
            <Setter Property="Background"       Value="#12122A"/>
            <Setter Property="Foreground"       Value="#E0E0E0"/>
            <Setter Property="CaretBrush"       Value="#E0E0E0"/>
            <Setter Property="BorderBrush"      Value="#2D2D4A"/>
            <Setter Property="BorderThickness"  Value="1"/>
            <Setter Property="Padding"          Value="8,5"/>
            <Setter Property="FontFamily"       Value="Consolas"/>
            <Setter Property="FontSize"         Value="12"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- DataGrid ìŠ¤íƒ€ì¼ -->
        <Style TargetType="DataGrid">
            <Setter Property="Background"            Value="#12122A"/>
            <Setter Property="Foreground"            Value="#C8C8D8"/>
            <Setter Property="BorderBrush"           Value="#2D2D4A"/>
            <Setter Property="BorderThickness"       Value="1"/>
            <Setter Property="GridLinesVisibility"   Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#1E1E3A"/>
            <Setter Property="RowBackground"         Value="Transparent"/>
            <Setter Property="AlternatingRowBackground" Value="#15152C"/>
            <Setter Property="HeadersVisibility"     Value="Column"/>
            <Setter Property="SelectionMode"         Value="Single"/>
            <Setter Property="IsReadOnly"            Value="True"/>
            <Setter Property="AutoGenerateColumns"   Value="False"/>
            <Setter Property="CanUserAddRows"        Value="False"/>
            <Setter Property="CanUserDeleteRows"     Value="False"/>
            <Setter Property="CanUserReorderColumns" Value="False"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background"   Value="#1E1E38"/>
            <Setter Property="Foreground"   Value="#888888"/>
            <Setter Property="Padding"      Value="8,5"/>
            <Setter Property="BorderBrush"  Value="#2D2D4A"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="FontSize"     Value="11"/>
            <Setter Property="FontWeight"   Value="Bold"/>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding"         Value="6,3"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Padding="{TemplateBinding Padding}"
                                Background="{TemplateBinding Background}">
                            <ContentPresenter/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#2A2A50"/>
                </Trigger>
            </Style.Triggers>
        </Style>

    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>  <!-- ë“œë¡­ì¡´ -->
            <RowDefinition Height="Auto"/>  <!-- íŒ¨í„´ ìž…ë ¥ -->
            <RowDefinition Height="*"/>     <!-- DataGrid ë¯¸ë¦¬ë³´ê¸° -->
            <RowDefinition Height="Auto"/>  <!-- í•˜ë‹¨ ë²„íŠ¼ -->
        </Grid.RowDefinitions>

        <!-- â”€â”€ ë“œë¡­ì¡´ â”€â”€ -->
        <Border Grid.Row="0" Margin="12,12,12,6"
                Background="#12122A" CornerRadius="8"
                BorderBrush="#2D2D4A" BorderThickness="2"
                MinHeight="70">
            <Border.Style>
                <Style TargetType="Border">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsDragOver, RelativeSource={RelativeSource AncestorType=Window}}" Value="True">
                            <Setter Property="BorderBrush" Value="#00BCD4"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            <Grid>
                <StackPanel x:Name="DropHint" VerticalAlignment="Center"
                            HorizontalAlignment="Center" IsHitTestVisible="False">
                    <TextBlock Text="ðŸ“‚ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œëž˜ê·¸ì•¤ë“œë¡­"
                               FontSize="14" Foreground="#555577"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="ë˜ëŠ” ì•„ëž˜ ë²„íŠ¼ìœ¼ë¡œ ì¶”ê°€"
                               FontSize="11" Foreground="#444466"
                               HorizontalAlignment="Center" Margin="0,4,0,0"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center"
                            HorizontalAlignment="Right" Margin="12">
                    <Button Content="+ íŒŒì¼ ì¶”ê°€" Style="{StaticResource DarkBtn}"
                            Click="BtnAddFiles_Click" Margin="0,0,6,0"/>
                    <Button Content="ðŸ“ í´ë”" Style="{StaticResource DarkBtn}"
                            Click="BtnAddFolder_Click" Margin="0,0,6,0"/>
                    <Button x:Name="BtnClear" Content="ì „ì²´ ì§€ìš°ê¸°"
                            Style="{StaticResource DangerBtn}"
                            Click="BtnClear_Click" IsEnabled="False"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- â”€â”€ íŒ¨í„´ ìž…ë ¥ â”€â”€ -->
        <Border Grid.Row="1" Margin="12,0,12,6"
                Background="#12122A" CornerRadius="8"
                BorderBrush="#2D2D4A" BorderThickness="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- íƒ­ -->
                <StackPanel Grid.Row="0" Orientation="Horizontal">
                    <ToggleButton x:Name="TabPattern" Content="íŒ¨í„´ ëª¨ë“œ"
                                  Style="{StaticResource TabBtn}"
                                  IsChecked="True"
                                  Checked="TabPattern_Checked"/>
                    <ToggleButton x:Name="TabRegex" Content="ì •ê·œì‹ ëª¨ë“œ"
                                  Style="{StaticResource TabBtn}"
                                  Checked="TabRegex_Checked"/>
                </StackPanel>
                <Border Grid.Row="0" Height="1" Background="#2D2D4A"
                        VerticalAlignment="Bottom"/>

                <!-- íŒ¨í„´ ëª¨ë“œ ìž…ë ¥ -->
                <StackPanel x:Name="PatternPanel" Grid.Row="1" Margin="10,8,10,4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="íŒ¨í„´" VerticalAlignment="Center"
                                   Foreground="#888888" FontSize="11"/>
                        <TextBox x:Name="TxtPattern" Grid.Column="1"
                                 Style="{StaticResource DarkTxt}"
                                 TextChanged="Input_Changed"
                                 Text="{}{name}_{date}_{num:3}.{ext}"/>
                    </Grid>
                    <WrapPanel Margin="50,6,0,2">
                        <TextBlock Text="ë³€ìˆ˜: " Foreground="#555577" FontSize="10"/>
                        <Button Style="{StaticResource DarkBtn}" Content="{}{name}"
                                FontFamily="Consolas" FontSize="10" Padding="4,2"
                                Margin="0,0,4,0" Click="VarBtn_Click" Tag="{}{name}"/>
                        <Button Style="{StaticResource DarkBtn}" Content="{}{ext}"
                                FontFamily="Consolas" FontSize="10" Padding="4,2"
                                Margin="0,0,4,0" Click="VarBtn_Click" Tag="{}{ext}"/>
                        <Button Style="{StaticResource DarkBtn}" Content="{}{date}"
                                FontFamily="Consolas" FontSize="10" Padding="4,2"
                                Margin="0,0,4,0" Click="VarBtn_Click" Tag="{}{date}"/>
                        <Button Style="{StaticResource DarkBtn}" Content="{}{num:3}"
                                FontFamily="Consolas" FontSize="10" Padding="4,2"
                                Margin="0,0,4,0" Click="VarBtn_Click" Tag="{}{num:3}"/>
                        <Button Style="{StaticResource DarkBtn}" Content="{}{exif}"
                                FontFamily="Consolas" FontSize="10" Padding="4,2"
                                Click="VarBtn_Click" Tag="{}{exif}"/>
                    </WrapPanel>
                </StackPanel>

                <!-- ì •ê·œì‹ ëª¨ë“œ ìž…ë ¥ -->
                <StackPanel x:Name="RegexPanel" Grid.Row="1"
                            Margin="10,8,10,4" Visibility="Collapsed">
                    <Grid Margin="0,0,0,6">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="ì°¾ê¸°" VerticalAlignment="Center"
                                   Foreground="#888888" FontSize="11"/>
                        <TextBox x:Name="TxtRegexFind" Grid.Column="1"
                                 Style="{StaticResource DarkTxt}"
                                 TextChanged="Input_Changed"/>
                    </Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="ë°”ê¾¸ê¸°" VerticalAlignment="Center"
                                   Foreground="#888888" FontSize="11"/>
                        <TextBox x:Name="TxtRegexReplace" Grid.Column="1"
                                 Style="{StaticResource DarkTxt}"
                                 TextChanged="Input_Changed"/>
                    </Grid>
                </StackPanel>

                <!-- ìƒíƒœ ë©”ì‹œì§€ -->
                <TextBlock x:Name="TxtInputStatus" Grid.Row="2"
                           Margin="12,2,12,6" FontSize="10"
                           Foreground="#888888" TextWrapping="Wrap"/>
            </Grid>
        </Border>

        <!-- â”€â”€ ë¯¸ë¦¬ë³´ê¸° DataGrid â”€â”€ -->
        <DataGrid x:Name="Grid" Grid.Row="2" Margin="12,0,12,6">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ì›ë³¸ íŒŒì¼ëª…"
                                    Binding="{Binding OriginalName}"
                                    Width="*" FontFamily="Consolas" FontSize="11"/>
                <DataGridTemplateColumn Header="ë³€ê²½ë  ì´ë¦„" Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock FontFamily="Consolas" FontSize="11"
                                       Text="{Binding PreviewName}">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="#00BCD4"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding HasError}" Value="True">
                                                <Setter Property="Foreground" Value="#FF5252"/>
                                                <Setter Property="Text" Value="{Binding ErrorMessage}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- â”€â”€ í•˜ë‹¨ ë²„íŠ¼ â”€â”€ -->
        <Grid Grid.Row="3" Margin="12,0,12,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" Grid.Column="0">
                <Button Content="ì„ íƒ ì œê±°" Style="{StaticResource DarkBtn}"
                        Click="BtnRemoveSelected_Click" Margin="0,0,6,0"/>
            </StackPanel>

            <TextBlock x:Name="TxtStatus" Grid.Column="1"
                       VerticalAlignment="Center" HorizontalAlignment="Center"
                       Foreground="#666688" FontSize="11"/>

            <StackPanel Orientation="Horizontal" Grid.Column="2">
                <Button x:Name="BtnUndo" Content="â†© ë˜ëŒë¦¬ê¸°"
                        Style="{StaticResource DarkBtn}"
                        Click="BtnUndo_Click" IsEnabled="False" Margin="0,0,6,0"/>
                <Button x:Name="BtnApply" Content="âœ“ ì ìš©"
                        Style="{StaticResource AccentBtn}"
                        Click="BtnApply_Click" IsEnabled="False"/>
            </StackPanel>
        </Grid>

    </Grid>
</Window>
