<UserControl x:Class="LogTail.Controls.LogTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="#0D0D14">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ── 필터 바 ── -->
        <Border Grid.Row="0" Background="#131320"
                BorderBrush="#2A2A3A" BorderThickness="0,0,0,1"
                Padding="8,6">
            <WrapPanel>
                <TextBlock Text="필터:" Foreground="#888898" FontSize="12"
                           VerticalAlignment="Center" Margin="0,0,6,0"/>
                <TextBox x:Name="TxtFilter" Width="200" Height="28" Margin="0,0,8,0"
                         VerticalContentAlignment="Center"
                         TextChanged="TxtFilter_TextChanged"
                         ToolTip="키워드 또는 정규식 입력 (Enter 적용)"/>
                <CheckBox x:Name="ChkRegex"   Content="정규식"   Margin="0,0,8,0"
                          Checked="FilterOptionChanged" Unchecked="FilterOptionChanged"/>
                <CheckBox x:Name="ChkCase"    Content="대소문자" Margin="0,0,8,0"
                          Checked="FilterOptionChanged" Unchecked="FilterOptionChanged"/>
                <CheckBox x:Name="ChkExclude" Content="제외"     Margin="0,0,12,0"
                          Checked="FilterOptionChanged" Unchecked="FilterOptionChanged"/>

                <!-- 구분선 -->
                <Border Width="1" Margin="0,3,12,3" Background="#2A2A3A" VerticalAlignment="Stretch"/>

                <CheckBox x:Name="ChkAutoScroll" Content="자동 스크롤" IsChecked="True"
                          Margin="0,0,12,0"/>

                <!-- UTC/현지 토글 -->
                <Button x:Name="BtnTimeMode" Content="현지" Width="52" Height="28"
                        Style="{StaticResource SecondaryBtn}"
                        Click="BtnTimeMode_Click"
                        ToolTip="UTC/현지 시간 전환"/>

                <Button x:Name="BtnClear" Content="지우기" Height="28" Margin="6,0,0,0"
                        Style="{StaticResource SecondaryBtn}"
                        Click="BtnClear_Click"
                        ToolTip="현재 탭 로그 지우기"/>
            </WrapPanel>
        </Border>

        <!-- ── 로그 목록 ── -->
        <ListBox Grid.Row="1" x:Name="LstLog"
                 VirtualizingStackPanel.IsVirtualizing="True"
                 VirtualizingStackPanel.VirtualizationMode="Recycling"
                 ScrollViewer.CanContentScroll="True"
                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                 SelectionMode="Extended"
                 FontFamily="Consolas" FontSize="12">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <!-- 줄 번호 -->
                        <TextBlock Text="{Binding NumberStr}"
                                   Foreground="#363646"
                                   FontFamily="Consolas" FontSize="11"
                                   HorizontalAlignment="Right"
                                   Padding="0,2,8,2"
                                   VerticalAlignment="Top"/>
                        <!-- 로그 내용 -->
                        <TextBlock Grid.Column="1"
                                   Text="{Binding DisplayText}"
                                   Foreground="{Binding LevelBrush}"
                                   FontFamily="Consolas" FontSize="12"
                                   Padding="0,2,4,2"
                                   TextWrapping="NoWrap"/>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!-- ── 상태 바 ── -->
        <Border Grid.Row="2" Background="#131320"
                BorderBrush="#2A2A3A" BorderThickness="0,1,0,0"
                Padding="8,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="TxtFilePath"
                               Foreground="#555565" FontSize="11" VerticalAlignment="Center"/>
                    <TextBlock Text=" | " Foreground="#333343" FontSize="11" VerticalAlignment="Center"/>
                    <TextBlock x:Name="TxtLineCount"
                               Foreground="#888898" FontSize="11" VerticalAlignment="Center"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Ellipse x:Name="EllStatus" Width="7" Height="7"
                             Fill="#22C55E" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBlock x:Name="TxtWatchStatus"
                               Text="감시 중" Foreground="#22C55E" FontSize="11" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
